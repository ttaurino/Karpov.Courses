#### Задание 3

Метрики — показатели, с помощью которых измеряют эффективность процессов на каждом этапе. Суть метрики - придумать такой численный показатель, который бы наиболее репрезентативно и одним числом показывал положение дел в конкретном процессе. Также метрику должно быть удобно отслеживать в динамике.

**Задачи**:

1. Посчитать OnTime - Метрика своевременности доставки. (Доставили в плановую дату доставки или нет), в %

 - Необходимо видеть изменение метрики по дням;

 - Необходимы разрезы по перевозчикам, по типу доставки, по кластерам склада, по таймслотам;

2. Посчитать PromisedClick2Delivery - метрика обещанного срока доставки (от даты заказа до первой плановой даты доставки), в сутках.

 - Необходима динамика по дням, неделям, месяцам;

 - Необходимо сравнение перевозчиков;

 - Необходимо понимание уровня метрики из кластера в кластер.

3. Посчитать Click2Delivery - метрика фактического срока доставки (от даты заказа до момента вручения), в сутках.

 - Необходимо сравнение с метрикой PromisedClick2Delivery;

 - Необходимо понимание кластеров, где заказы доставляются быстрее, чем мы обещаем клиентам;

4. Посчитать GMV Accepted - метрика совокупного объема продаж (считается по заказам, оформленным в указанный день), в рублях.

 - Необходимо видеть изменение метрики по дням;

 - Необходимы разрезы по перевозчикам, по типу доставки, по кластерам склада;

5. Посчитать Return Rate - доля возвратов (отношение количества возвратов к заказам в этот день), в %.

 - Необходимо видеть изменение метрики по дням;

 - Необходимы разрезы по перевозчикам, по кластерам склада и клиента;

6. Посчитать GMV D-R - метрика, отражающая совокупный объем доставленных заказов за вычетом возвратов, в рублях.

 - Необходимо видеть изменение метрики по дням (для всех дней, которые были раньше, чем дата расчета метрики);

 - Необходимы разрезы по перевозчикам, по типу доставки, по кластерам склада.

#### Описание таблиц
Все данные находятся в табличном виде в Clickhouse

Таблица **logistics_online** содержит данные о логистике.

date_order - дата, в которую клиент оформляет заказ

number_order - уникальный номер заказа клиента (в столбце номер может повторяться, т.к. заказы переносятся и имеют раные даты доставки)

timeslot_number - нумерация кол-ва попыток доставить в плановую дату доставки. Если доставка не была осуществлена, то заказ переносится на новую дату

result_data_order - дата, в которую заказ был доставлен клиенту

delivery_type - выбранный клиентом способ получения заказа (курьерка или самовывоз)

carrier_name - перевозчик, которым заказ доставляется клиенту

planned_data_order - планируемая дата заказа

seller_ID - уникальный идентификатор продавца

order_status - последний актуальный статус заказа (фиксируется во всех строках последний статус заказа)

customer_cluster - региональная принадлежность клиента

warehouse_cluster - региональная принадлежность продавца
    
Таблица **product_online** содержит данные о товарах в заказе.

number_order - уникальный номер заказа клиента (в столбце номер может повторяться, т.к. так как в одном заказе может быть несколько товаров)

product_ID - уникальный номер товара (В столбце номер может повторяться, т.к. так как один товар может быть в заказах нескольких клиентов)

product_price - стоимость одной единицы товара в рублях

amount - количество единиц товара в заказе

Таблица **returns_online** содержит данные о возвратах

number_order - уникальный номер заказа клиента (в столбце номер может повторяться, т.к. так как в одном заказе может быть несколько товаров)

product_ID - уникальный номер товара (в столбце номер может повторяться, т.к. так как один товар может быть в заказах нескольких клиентов)

amount_return - количество единиц товара, которые были возвращены (не больше, чем количество единиц товара, приобретенных в указаном заказе)

return_date - дата совершения возврата
